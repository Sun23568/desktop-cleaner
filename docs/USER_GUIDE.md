# 📖 用户使用指南

## 🎉 新功能：自定义AI配置

现在你可以在界面上直接配置AI引擎和API Key，无需修改代码！

---

## 🚀 快速开始

### 1. 启动程序
```bash
python main.py
```

### 2. 打开设置
点击右上角的 **"⚙ 设置"** 按钮

### 3. 选择AI引擎

你有两个选择：

#### 选项A：通义千问（智能分析）
1. 在"选择引擎"下拉框中选择 **"通义千问"**
2. 在"API Key"框中输入你的API Key
3. 选择模型（推荐使用 `qwen-plus`）
4. 点击"保存"

**获取API Key：**
- 点击设置对话框中的链接，或访问：https://dashscope.aliyun.com/
- 注册/登录后，在"API Key"页面创建密钥

#### 选项B：规则引擎（完全离线）
1. 在"选择引擎"下拉框中选择 **"规则引擎"**
2. 调整规则参数（可选）
3. 点击"保存"

---

## 💡 功能说明

### 设置界面

#### AI提供商选择
- **通义千问**: 使用云端AI，智能分析文件，需要API Key
- **规则引擎**: 基于规则的本地分析，完全离线，无需API Key

#### 通义千问配置
- **API Key**: 你的通义千问API密钥
- **模型**:
  - `qwen-plus`: 推荐，性价比高
  - `qwen-max`: 最强，但更贵
  - `qwen-turbo`: 速度快，适合大量文件
  - `qwen3-coder-plus`: 适合代码文件

#### 规则引擎配置
- **旧文件阈值**: 多少天未修改算作旧文件（默认90天）
- **临时文件阈值**: 临时文件多少天未修改可删除（默认7天）

#### 高级设置
- **启用自动降级**: AI失败时自动切换到规则引擎
- **批次大小**: 每次分析的文件数量
- **超时时间**: API调用超时时间

---

## 📝 使用流程

### 完整流程

1. **首次使用**
   - 启动程序
   - 点击"⚙ 设置"
   - 配置AI引擎和API Key
   - 保存设置

2. **扫描文件**
   - 点击"开始扫描"
   - 等待扫描完成
   - 查看扫描到的文件列表

3. **AI分析**
   - 选择要分析的文件（默认全选）
   - 点击"AI分析"
   - 等待AI分析完成
   - 查看AI建议

4. **执行操作**
   - 检查AI建议
   - 点击"执行操作"
   - 确认后执行

---

## ⚙️ 配置保存位置

你的配置会自动保存在：
```
Windows: C:\Users\你的用户名\.desktop-cleaner\user_config.json
Linux/Mac: ~/.desktop-cleaner/user_config.json
```

配置文件包含：
- AI引擎选择
- API Key（加密保存）
- 模型选择
- 所有自定义参数

---

## 🔄 切换AI引擎

### 方式1：设置界面（推荐）
1. 点击"⚙ 设置"
2. 选择不同的引擎
3. 保存

### 方式2：窗口标题显示
窗口标题会显示当前使用的引擎：
- `智能桌面清理工具 - 当前引擎: 通义千问`
- `智能桌面清理工具 - 当前引擎: 规则引擎`

---

## 💰 成本说明

### 通义千问（付费）
- 需要API Key
- 按Token计费
- 价格参考：https://dashscope.aliyun.com/pricing

### 规则引擎（免费）
- 完全免费
- 完全离线
- 基于规则判断

---

## 🛠️ 故障排查

### Q1: 提示"API Key未配置"
**解决**：
1. 打开"⚙ 设置"
2. 确认已填写API Key
3. 点击"测试连接"验证

### Q2: AI分析失败
**解决**：
1. 检查网络连接
2. 验证API Key是否正确
3. 或者切换到"规则引擎"

### Q3: 想完全离线使用
**解决**：
1. 打开"⚙ 设置"
2. 选择"规则引擎"
3. 保存

### Q4: 设置没有保存
**解决**：
1. 确认点击了"保存"按钮（不是"取消"）
2. 查看日志区是否有错误信息
3. 检查配置文件目录权限

---

## 🎯 最佳实践

### 场景1：日常使用
```
引擎: 通义千问
自动降级: 开启
批次大小: 10
```
智能分析，失败自动降级

### 场景2：内网环境
```
引擎: 规则引擎
```
完全离线，无需网络

### 场景3：大量文件
```
引擎: 规则引擎
或
引擎: 通义千问
模型: qwen-turbo
批次大小: 20
```
快速处理

### 场景4：重要文件
```
引擎: 通义千问
模型: qwen-max
自动降级: 关闭
```
使用最强模型

---

## 🔒 安全说明

### API Key安全
- API Key保存在本地配置文件
- 不会上传到服务器
- 仅用于调用通义千问API
- 建议定期更换

### 数据隐私
- **通义千问**: 文件名和元数据会发送到阿里云
- **规则引擎**: 完全本地，不上传任何数据

---

## ❓ 常见问题

**Q: 配置会不会丢失？**
A: 不会，配置保存在本地文件，重启程序自动加载

**Q: 可以多个API Key切换吗？**
A: 可以随时在设置中更改API Key

**Q: 规则引擎够用吗？**
A: 对于简单的文件分类够用，复杂场景建议用AI

**Q: 能自定义规则吗？**
A: 可以调整规则参数，如旧文件阈值

**Q: API Key会过期吗？**
A: 取决于阿里云设置，过期后重新配置即可

---

## 📞 获取帮助

- 查看：`docs/AI_PROVIDERS_GUIDE.md`
- 查看：`docs/QUICK_START.md`
- 查看：`README_AI_PROVIDERS.md`

---

## 🎉 开始使用吧！

1. 启动程序
2. 点击"⚙ 设置"
3. 配置你的AI引擎
4. 开始智能清理！
