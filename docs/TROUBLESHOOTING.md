# æ•…éšœæ’é™¤æŒ‡å—

æœ¬æ–‡æ¡£åˆ—å‡ºäº†å¸¸è§é—®é¢˜åŠå…¶è§£å†³æ–¹æ¡ˆã€‚

## ğŸ”´ æ‰“åŒ…ç›¸å…³é—®é¢˜

### é—®é¢˜ 1: ModuleNotFoundError: No module named 'imp'

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'imp'
```

**åŸå› **:
- ä½ çš„ Python ç‰ˆæœ¬å¤ªæ–°ï¼ˆ3.12 æˆ–æ›´é«˜ï¼‰
- PyInstaller è¿˜ä¸æ”¯æŒ Python 3.12+ï¼Œå› ä¸º `imp` æ¨¡å—å·²è¢«ç§»é™¤

**è§£å†³æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆä¸€ï¼šå®‰è£… Python 3.11ï¼ˆæ¨èï¼‰

**Windows**:
1. ä¸‹è½½ [Python 3.11](https://www.python.org/downloads/release/python-3119/)
2. å®‰è£…æ—¶å‹¾é€‰ "Add Python to PATH"
3. å®‰è£…å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰“åŒ…ï¼š
   ```batch
   py -3.11 -m pip install -r requirements.txt
   py -3.11 -m pip install pyinstaller
   py -3.11 -m PyInstaller build\desktop_cleaner.spec
   ```

**Linux/macOS**:
```bash
# ä½¿ç”¨ pyenv å®‰è£… Python 3.11
pyenv install 3.11.0
pyenv local 3.11.0

# é‡æ–°è¿è¡Œæ‰“åŒ…è„šæœ¬
./build/build.sh
```

#### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

**Windows**:
```batch
# å®‰è£… Python 3.11 ååˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
py -3.11 -m venv venv311
venv311\Scripts\activate
pip install -r requirements.txt
pip install pyinstaller
pyinstaller build\desktop_cleaner.spec
```

**Linux/macOS**:
```bash
# å®‰è£… Python 3.11 ååˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.11 -m venv venv311
source venv311/bin/activate
pip install -r requirements.txt
pip install pyinstaller
pyinstaller build/desktop_cleaner.spec
```

#### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ Conda

```bash
# åˆ›å»º Python 3.11 ç¯å¢ƒ
conda create -n desktop-cleaner python=3.11
conda activate desktop-cleaner

# å®‰è£…ä¾èµ–å¹¶æ‰“åŒ…
pip install -r requirements.txt
pip install pyinstaller
pyinstaller build/desktop_cleaner.spec
```

---

### é—®é¢˜ 2: pkg_resources is deprecated

**é”™è¯¯ä¿¡æ¯**:
```
UserWarning: pkg_resources is deprecated as an API
```

**åŸå› **:
- Setuptools ç‰ˆæœ¬è¿‡é«˜
- è¿™åªæ˜¯è­¦å‘Šï¼Œä¸å½±å“æ‰“åŒ…

**è§£å†³æ–¹æ¡ˆ**ï¼ˆå¯é€‰ï¼‰:
```bash
pip install "setuptools<81"
```

---

### é—®é¢˜ 3: æ‰“åŒ…åæ–‡ä»¶è¿‡å¤§

**é—®é¢˜æè¿°**:
æ‰“åŒ…åçš„ exe æ–‡ä»¶è¶…è¿‡ 100MB

**è§£å†³æ–¹æ¡ˆ**:

1. **æ’é™¤ä¸éœ€è¦çš„åº“**

   ç¼–è¾‘ `build/desktop_cleaner.spec`ï¼Œåœ¨ `excludes` ä¸­æ·»åŠ ï¼š
   ```python
   excludes=[
       'matplotlib',
       'numpy',
       'pandas',
       'PIL',
       'scipy',
       'tkinter',
       'pytest',
       'IPython',
   ],
   ```

2. **å¯ç”¨ UPX å‹ç¼©**ï¼ˆå·²é»˜è®¤å¯ç”¨ï¼‰

   ç¡®ä¿ spec æ–‡ä»¶ä¸­æœ‰ï¼š
   ```python
   upx=True,
   ```

3. **ä½¿ç”¨ onefile æ¨¡å¼**ï¼ˆå·²é»˜è®¤å¯ç”¨ï¼‰

   å•æ–‡ä»¶æ¨¡å¼ä¼šè‡ªåŠ¨å‹ç¼©ã€‚

---

### é—®é¢˜ 4: æ‰“åŒ…å¤±è´¥ - æ‰¾ä¸åˆ°æ¨¡å—

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'XXX'
```

**è§£å†³æ–¹æ¡ˆ**:

ç¼–è¾‘ `build/desktop_cleaner.spec`ï¼Œåœ¨ `hiddenimports` ä¸­æ·»åŠ ç¼ºå¤±çš„æ¨¡å—ï¼š
```python
hiddenimports=[
    'PyQt6.QtCore',
    'PyQt6.QtGui',
    'PyQt6.QtWidgets',
    'dashscope',
    'requests',
    'XXX',  # æ·»åŠ ç¼ºå¤±çš„æ¨¡å—
],
```

---

## ğŸŸ¡ è¿è¡Œæ—¶é—®é¢˜

### é—®é¢˜ 5: æ‰“åŒ…åè¿è¡ŒæŠ¥é”™

**é—®é¢˜æè¿°**:
åŒå‡» exe æ–‡ä»¶åé—ªé€€æˆ–æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:

1. **æŸ¥çœ‹è¯¦ç»†é”™è¯¯**

   ä¿®æ”¹ `build/desktop_cleaner.spec`ï¼š
   ```python
   console=True,  # æ”¹ä¸º True æ˜¾ç¤ºæ§åˆ¶å°
   ```

   é‡æ–°æ‰“åŒ…å¹¶è¿è¡Œï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚

2. **æ£€æŸ¥ä¾èµ–æ–‡ä»¶**

   ç¡®ä¿æ‰€æœ‰éœ€è¦çš„æ–‡ä»¶éƒ½åœ¨ `datas` ä¸­ï¼š
   ```python
   datas=[
       ('resources', 'resources'),
       ('config.json', '.'),
   ],
   ```

---

### é—®é¢˜ 6: æ€æ¯’è½¯ä»¶æŠ¥è­¦

**é—®é¢˜æè¿°**:
æ‰“åŒ…åçš„ exe è¢«æ€æ¯’è½¯ä»¶æ‹¦æˆª

**è§£å†³æ–¹æ¡ˆ**:

1. **æ·»åŠ åˆ°ç™½åå•**
   - åœ¨æ€æ¯’è½¯ä»¶ä¸­æ·»åŠ ä¿¡ä»»

2. **ä»£ç ç­¾å**ï¼ˆæ¨èï¼‰
   - è´­ä¹°ä»£ç ç­¾åè¯ä¹¦
   - ä½¿ç”¨ `signtool` ç­¾å

3. **æŠ¥å‘Šè¯¯æŠ¥**
   - å‘æ€æ¯’è½¯ä»¶å‚å•†æŠ¥å‘Šè¯¯æŠ¥

---

## ğŸŸ¢ UI ç›¸å…³é—®é¢˜

### é—®é¢˜ 7: ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸

**é—®é¢˜æè¿°**:
- æŒ‰é’®é”™ä½
- æ–‡å­—é‡å 
- çª—å£è¿‡å°/è¿‡å¤§

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥ DPI è®¾ç½®**ï¼ˆWindowsï¼‰
   - å³é”®ç‚¹å‡» exe â†’ å±æ€§ â†’ å…¼å®¹æ€§
   - å‹¾é€‰"æ›¿ä»£é«˜ DPI ç¼©æ”¾è¡Œä¸º"

2. **é‡ç½®é…ç½®æ–‡ä»¶**
   ```bash
   # åˆ é™¤ç”¨æˆ·é…ç½®
   # Windows: C:\Users\ä½ çš„ç”¨æˆ·å\.desktop-cleaner\user_config.json
   # Linux/macOS: ~/.desktop-cleaner/user_config.json
   ```

---

### é—®é¢˜ 8: ä¸­æ–‡æ˜¾ç¤ºä¹±ç 

**é—®é¢˜æè¿°**:
ç•Œé¢æˆ–æ§åˆ¶å°ä¸­æ–‡æ˜¾ç¤ºä¸ºæ–¹å—æˆ–é—®å·

**è§£å†³æ–¹æ¡ˆ**:

1. **Windows**:
   - ç¡®ä¿ç³»ç»ŸåŒºåŸŸè®¾ç½®æ”¯æŒ UTF-8
   - æ§åˆ¶é¢æ¿ â†’ åŒºåŸŸ â†’ ç®¡ç† â†’ æ›´æ”¹ç³»ç»ŸåŒºåŸŸè®¾ç½® â†’ å‹¾é€‰"Beta: ä½¿ç”¨ Unicode UTF-8 æä¾›å…¨çƒè¯­è¨€æ”¯æŒ"

2. **æ‰“åŒ…è„šæœ¬ä¹±ç **:
   - è¿è¡Œ `build.bat` æ—¶å·²è‡ªåŠ¨è®¾ç½® UTF-8 ç¼–ç 
   - å¦‚ä»æœ‰é—®é¢˜ï¼Œæ‰‹åŠ¨è¿è¡Œï¼š
     ```batch
     chcp 65001
     build\build.bat
     ```

---

## ğŸ”µ API ç›¸å…³é—®é¢˜

### é—®é¢˜ 9: é€šä¹‰åƒé—® API è°ƒç”¨å¤±è´¥

**é—®é¢˜æè¿°**:
API Key æ­£ç¡®ä½†ä»ç„¶å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥ç½‘ç»œè¿æ¥**
   ```bash
   ping dashscope.aliyun.com
   ```

2. **æ£€æŸ¥ API Key æ ¼å¼**
   - ç¡®ä¿ä»¥ `sk-` å¼€å¤´
   - æ²¡æœ‰å¤šä½™ç©ºæ ¼

3. **æŸ¥çœ‹é¢åº¦**
   - ç™»å½• [é€šä¹‰åƒé—®æ§åˆ¶å°](https://dashscope.aliyun.com/)
   - æ£€æŸ¥å‰©ä½™é¢åº¦

4. **å¯ç”¨é™çº§**
   - è®¾ç½®ä¸­å¯ç”¨"è‡ªåŠ¨é™çº§"
   - AI å¤±è´¥æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨è§„åˆ™å¼•æ“

---

### é—®é¢˜ 10: è§„åˆ™å¼•æ“åˆ†ç±»ä¸å‡†ç¡®

**é—®é¢˜æè¿°**:
æ–‡ä»¶åˆ†ç±»é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

1. **è°ƒæ•´å‚æ•°**
   - è®¾ç½® â†’ è§„åˆ™å¼•æ“é…ç½®
   - ä¿®æ”¹"æ—§æ–‡ä»¶é˜ˆå€¼"å’Œ"ä¸´æ—¶æ–‡ä»¶é˜ˆå€¼"

2. **ä½¿ç”¨ AI å¼•æ“**
   - å¯¹äºå¤æ‚åœºæ™¯ï¼Œå»ºè®®ä½¿ç”¨é€šä¹‰åƒé—®

3. **è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™**
   - è®¾ç½® â†’ æ–‡ä»¶è¿‡æ»¤é…ç½®
   - æ·»åŠ è¦å¿½ç•¥çš„æ‰©å±•å

---

## ğŸ“ è·å–æ›´å¤šå¸®åŠ©

å¦‚æœä»¥ä¸Šæ–¹æ¡ˆéƒ½æ— æ³•è§£å†³ä½ çš„é—®é¢˜ï¼š

1. **æŸ¥çœ‹å®Œæ•´æ–‡æ¡£**
   - [BUILD_GUIDE.md](BUILD_GUIDE.md) - æ‰“åŒ…æŒ‡å—
   - [USER_GUIDE.md](USER_GUIDE.md) - ç”¨æˆ·æŒ‡å—
   - [CONFIG_GUIDE.md](CONFIG_GUIDE.md) - é…ç½®æŒ‡å—

2. **æäº¤ Issue**
   - åŒ…å«å®Œæ•´é”™è¯¯ä¿¡æ¯
   - è¯´æ˜æ“ä½œç³»ç»Ÿå’Œ Python ç‰ˆæœ¬
   - æè¿°å¤ç°æ­¥éª¤

3. **æŸ¥çœ‹æ—¥å¿—**
   - è¿è¡Œæ—¶æ—¥å¿—ä½ç½®ï¼š`~/.desktop-cleaner/logs/`ï¼ˆå¦‚æœæœ‰ï¼‰

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. âœ… ä½¿ç”¨ Python 3.11ï¼ˆè€Œä¸æ˜¯ 3.12+ï¼‰
2. âœ… ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒè¿›è¡Œæ‰“åŒ…
3. âœ… æ‰“åŒ…å‰æµ‹è¯•åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œ
4. âœ… å¯ç”¨è‡ªåŠ¨é™çº§åŠŸèƒ½
5. âœ… å®šæœŸæ›´æ–°ä¾èµ–åŒ…

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
